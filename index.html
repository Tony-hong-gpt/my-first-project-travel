<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>ì—¬í–‰ ë¦¬ë·° ë¶„ì„ ì‹¤í—˜ v2</title>
  <style>
    :root {
      --bg: #f3f4f6;
      --card-bg: #ffffff;
      --border-subtle: #e5e7eb;
      --text-main: #111827;
      --text-sub: #6b7280;
      --green: #16a34a;
      --green-soft: #ecfdf3;
      --red: #dc2626;
      --red-soft: #fef2f2;
      --neutral-soft: #f9fafb;
      --accent: #3b82f6;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        Arial, sans-serif;
      background: radial-gradient(circle at top, #e0f2fe 0, #f3f4f6 40%, #eef2ff 100%);
      color: var(--text-main);
    }

    .app {
      max-width: 960px;
      margin: 0 auto;
      padding: 32px 20px 48px;
    }

    h1 {
      margin: 0 0 12px;
      font-size: 1.8rem;
      letter-spacing: -0.03em;
    }

    .subtitle {
      margin: 0 0 20px;
      font-size: 0.95rem;
      color: var(--text-sub);
    }

    textarea {
      width: 100%;
      min-height: 140px;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid var(--border-subtle);
      font-size: 0.95rem;
      resize: vertical;
      outline: none;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
      background: rgba(255, 255, 255, 0.9);
    }
    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    button {
      border-radius: 999px;
      border: 1px solid transparent;
      padding: 8px 16px;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.08s ease,
        background-color 0.12s ease, border-color 0.12s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      color: white;
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.3);
    }
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(37, 99, 235, 0.35);
    }
    .btn-secondary {
      background: #ffffff;
      color: var(--text-main);
      border-color: var(--border-subtle);
    }
    .btn-secondary:hover {
      background: #f9fafb;
      border-color: #d1d5db;
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.06);
    }

    h2 {
      margin-top: 28px;
      font-size: 1.25rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .summary-bar {
      font-size: 0.9rem;
      color: var(--text-sub);
      margin-bottom: 12px;
    }

    /* ì¹´ë“œ ê³µí†µ ìŠ¤íƒ€ì¼ */
    .card {
      background: var(--card-bg);
      border-radius: 18px;
      padding: 14px 18px 16px;
      margin-bottom: 14px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow: 0 14px 35px rgba(15, 23, 42, 0.08);
      backdrop-filter: blur(10px);
    }

    /* ì ìˆ˜ì— ë”°ë¼ ì¹´ë“œ ë°°ê²½ / í…Œë‘ë¦¬ ìƒ‰ ë‹¤ë¥´ê²Œ */
    .card--good {
      background: linear-gradient(135deg, #ecfdf3, #f0fdf4);
      border-color: rgba(22, 163, 74, 0.35);
    }
    .card--bad {
      background: linear-gradient(135deg, #fef2f2, #fef2f2);
      border-color: rgba(220, 38, 38, 0.28);
    }
    .card--neutral {
      background: linear-gradient(135deg, #f9fafb, #ffffff);
      border-color: rgba(148, 163, 184, 0.3);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 6px;
    }

    .card-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-sub);
    }

    .score-pill {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }
    .score-pill--good {
      background: rgba(22, 163, 74, 0.08);
      color: var(--green);
    }
    .score-pill--bad {
      background: rgba(220, 38, 38, 0.08);
      color: var(--red);
    }
    .score-pill--neutral {
      background: rgba(107, 114, 128, 0.08);
      color: #374151;
    }

    /* ì‹ ë¢°ë„ ë°°ì§€ */
    .cred-pill{
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.82rem;
      font-weight: 800;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
      border: 1px solid transparent;
    }
    
    .cred--high{ background: rgba(22,163,74,0.10); color: #15803d; border-color: rgba(22,163,74,0.25); }
    .cred--mid { background: rgba(245,158,11,0.12); color: #92400e; border-color: rgba(245,158,11,0.30); }
    .cred--low { background: rgba(220,38,38,0.10); color: #b91c1c; border-color: rgba(220,38,38,0.25); }
    
    .card-header-right{
      display:flex;
      align-items:center;
      gap:8px;
    }

    .review-text {
      font-size: 0.95rem;
      line-height: 1.5;
      margin-top: 4px;
      margin-bottom: 8px;
    }

    .meta-row {
      font-size: 0.8rem;
      color: var(--text-sub);
      margin-bottom: 6px;
    }

    .meta-row strong {
      margin-right: 4px;
      color: #4b5563;
    }

    .tag-group {
      font-size: 0.8rem;
      margin-top: 4px;
    }

    .tag-group-label {
      font-weight: 600;
      margin-right: 4px;
      color: #4b5563;
    }

    .chip-empty {
      font-size: 0.8rem;
      color: #9ca3af;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      padding: 3px 8px;
      margin: 2px 4px 0 0;
      border-radius: 999px;
      font-size: 0.78rem;
      font-weight: 600;
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .card-summary {
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px dashed rgba(148, 163, 184, 0.7);
      font-size: 0.85rem;
      color: var(--text-sub);
    }

    @media (max-width: 640px) {
      .app {
        padding: 20px 14px 32px;
      }
      .card {
        padding: 12px 14px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>ì—¬í–‰ ë¦¬ë·° AI ì‹¤í—˜ v2</h1>
    <p class="subtitle">
      ì—¬ëŸ¬ ê°œì˜ ì—¬í–‰ ë¦¬ë·°ë¥¼ ì¤„ë°”ê¿ˆìœ¼ë¡œ ë‚˜ëˆ ì„œ ì…ë ¥í•´ë³´ì„¸ìš”. ê°„ë‹¨í•œ ê·œì¹™ ê¸°ë°˜ìœ¼ë¡œ
      ì ìˆ˜ì™€ í‚¤ì›Œë“œë¥¼ ë¶„ì„í•©ë‹ˆë‹¤.
    </p>

    <p style="font-size: 0.9rem; color: #6b7280;">
      ì˜ˆì‹œ)<br />
      ìœ„ì¹˜ë„ ì¢‹ê³  ì§ì›ë“¤ì´ ì •ë§ ì¹œì ˆí–ˆì–´ìš”.<br />
      ë°©ì€ ê¹¨ë—í–ˆì§€ë§Œ ì†ŒìŒì´ ë„ˆë¬´ ì‹¬í–ˆìŠµë‹ˆë‹¤.
    </p>

    <textarea id="reviews"></textarea>

    <div class="controls">
      <button type="button" class="btn-secondary" onclick="fillSample()">
        ìƒ˜í”Œ ë¦¬ë·° ë¶ˆëŸ¬ì˜¤ê¸°
      </button>
      <button type="button" class="btn-primary" onclick="analyzeAll()">
        ëª¨ë‘ ë¶„ì„í•˜ê¸°
      </button>
    </div>

    <h2>ê²°ê³¼:</h2>
    <div id="output"></div>
  </div>

  <script>
    // 1. ì ìˆ˜ ê³„ì‚°
    function scoreReview(text) {
      text = text.replace(/\s+/g, " ").trim();
      let score = 50;

      if (text.includes("ì¢‹")) score += 10;
      if (text.includes("ì¶”ì²œ")) score += 10;
      if (text.includes("ë§Œì¡±")) score += 10;
      if (text.includes("ìµœê³ ")) score += 5;
      if (text.includes("ì™„ë²½")) score += 5;
      if (text.includes("ì¹œì ˆ")) score += 10;
      if (text.includes("ê¸°ì¨")) score += 10;
      if (text.includes("ê¸°ë¶„")) score += 10;

      if (text.includes("ë³„ë¡œ")) score -= 20;
      if (text.includes("ì‹¤ë§")) score -= 20;
      if (text.includes("ìµœì•…")) score -= 20;
      if (text.includes("ë¹„ìŒŒ")) score -= 10;
      if (text.includes("ë¶ˆí¸")) score -= 10;
      if (text.includes("ì‹œë„ëŸ½")) score -= 10;
      if (text.includes("ì†ŒìŒ")) score -= 10;

      if (score > 100) score = 100;
      if (score < 0) score = 0;
      return score;
    }

    // 2. í‚¤ì›Œë“œ ì¶”ì¶œ
    function extractKeywords(text) {
      const positive = ["ì¢‹", "ë§Œì¡±", "í¸ì•ˆ", "ì¹œì ˆ", "ìµœê³ ", "ê¸°ë¶„"];
      const negative = ["ë³„ë¡œ", "ë¶ˆí¸", "ì‹¤ë§", "ë¹„ìŒŒ", "ì†ŒìŒ", "ì‹œë„ëŸ½", "ì¢", "ë”ëŸ½"];
      const facility = ["ë°©", "ë£¸", "í™”ì¥ì‹¤", "ì¹¨ëŒ€", "ì²­ì†Œ", "ì‹œì„¤", "ìš•ì‹¤"];
      const service = ["ì§ì›", "ì‘ëŒ€", "ì„œë¹„ìŠ¤", "ì¹œì ˆ"];
      const location = ["ìœ„ì¹˜", "êµí†µ", "ì—­", "ê·¼ì²˜"];
      const price = ["ê°€ê²©", "ê°€ì„±ë¹„", "ë¹„ì‹¸", "ì €ë ´"];

      function findMatches(words) {
        return words.filter((w) => text.includes(w));
      }

      return {
        positive: findMatches(positive),
        negative: findMatches(negative),
        facility: findMatches(facility),
        service: findMatches(service),
        location: findMatches(location),
        price: findMatches(price),
      };
    }

// 3. ê³ ê¸‰ ìš”ì•½ ë¬¸ì¥ (ì ìˆ˜ + í‚¤ì›Œë“œ + ì‹ ë¢°ë„ ë°˜ì˜)
function summarizeReview(kw, score, credibility) {
  const posCount = kw.positive.length;
  const negCount = kw.negative.length;

  // 1) í†¤(ë¶„ìœ„ê¸°) ë¬¸ì¥
  let toneLabel = "";
  if (score >= 85 && posCount > negCount) {
    toneLabel = "ë§¤ìš° ë§Œì¡±ë„ê°€ ë†’ì€ í›„ê¸°ì…ë‹ˆë‹¤.";
  } else if (score >= 70 && posCount >= negCount) {
    toneLabel = "ëŒ€ì²´ë¡œ ë§Œì¡±ìŠ¤ëŸ¬ìš´ í›„ê¸°ì…ë‹ˆë‹¤.";
  } else if (negCount > posCount && score <= 60) {
    toneLabel = "ì•„ì‰¬ìš´ ì ì´ ë” ë§ì´ ë“œëŸ¬ë‚˜ëŠ” í›„ê¸°ì…ë‹ˆë‹¤.";
  } else if (posCount === 0 && negCount === 0) {
    toneLabel = "ê°ì • í‘œí˜„ì´ í¬ì§€ ì•Šì€ ì¤‘ë¦½ì ì¸ í›„ê¸°ì…ë‹ˆë‹¤.";
  } else {
    toneLabel = "ì¢‹ì€ ì ê³¼ ì•„ì‰¬ìš´ ì ì´ í•¨ê»˜ ì„ì—¬ ìˆëŠ” í›„ê¸°ì…ë‹ˆë‹¤.";
  }

  // 2) ì–´ë–¤ ìš”ì†Œì— ëŒ€í•œ í›„ê¸°ì¸ì§€ (ìœ„ì¹˜/ì„œë¹„ìŠ¤/ì‹œì„¤/ê°€ê²©)
  const aspects = [];
  if (kw.location.length > 0) aspects.push("ìœ„ì¹˜");
  if (kw.service.length > 0) aspects.push("ì„œë¹„ìŠ¤");
  if (kw.facility.length > 0) aspects.push("ì‹œì„¤");
  if (kw.price.length > 0) aspects.push("ê°€ê²©");

  let aspectSentence = "";
  if (aspects.length === 1) {
    aspectSentence = `${aspects[0]}ì— ëŒ€í•œ í‰ê°€ê°€ ì¤‘ì‹¬ì…ë‹ˆë‹¤.`;
  } else if (aspects.length > 1) {
    aspectSentence = `${aspects.join(", ")} ë“± ì—¬ëŸ¬ ìš”ì†Œë¥¼ í•¨ê»˜ í‰ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤.`;
  }

  // 3) ì‹ ë¢°ë„ì— ë”°ë¥¸ ì½”ë©˜íŠ¸
  let credSentence = "";
  if (credibility >= 80) {
    credSentence = "êµ¬ì²´ì ì¸ ì •ë³´ê°€ ë§ì•„ ë¹„êµì  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë¦¬ë·°ë¡œ ë³´ì…ë‹ˆë‹¤.";
  } else if (credibility >= 60) {
    credSentence = "ì „ì²´ì ìœ¼ë¡œ ì°¸ê³ í•  ë§Œí•˜ì§€ë§Œ, ì„¸ë¶€ ì •ë³´ëŠ” ì¼ë¶€ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
  } else {
    credSentence = "í‘œí˜„ì´ ë‹¤ì†Œ ì¶”ìƒì ì´ì–´ì„œ ì‹ ë¢°ë„ëŠ” ë‚®ì€ í¸ì…ë‹ˆë‹¤.";
  }

  // 4) ì„¸ ë¬¸ì¥ì„ í•˜ë‚˜ì˜ ìš”ì•½ìœ¼ë¡œ í•©ì¹˜ê¸°
  return [toneLabel, aspectSentence, credSentence]
    .filter(Boolean)      // ë¹ˆ ë¬¸ìì—´ ì œê±°
    .join(" ");
}

    // ìƒ˜í”Œ ì±„ìš°ê¸°
    function fillSample() {
      const sampleLines = [
        "ìœ„ì¹˜ë„ ì¢‹ê³  ì§ì›ë“¤ì´ ì •ë§ ì¹œì ˆí•´ì„œ ë‹¤ì‹œ ì˜¤ê³  ì‹¶ì€ ê³³ì…ë‹ˆë‹¤. ì •ë§ ë§Œì¡±í•©ë‹ˆë‹¤.",
        "ë°©ì€ ê¹¨ë—í–ˆì§€ë§Œ ì†ŒìŒì´ ì¡°ê¸ˆ ì•„ì‰¬ì› ì–´ìš”.",
        "ê°€ê²©ì€ ì¡°ê¸ˆ ë¹„ìŒŒì§€ë§Œ ì„œë¹„ìŠ¤ì™€ ìœ„ì¹˜ëŠ” ë§¤ìš° ë§Œì¡±ìŠ¤ëŸ¬ì› ìŠµë‹ˆë‹¤.",
        "ì£¼ë³€ ê´€ê´‘ì§€ê°€ ë§ì•„ì„œ ì´ë™í•˜ê¸° í¸í–ˆìŠµë‹ˆë‹¤.",
        "ì§ì› ì‘ëŒ€ê°€ ì¹œì ˆí–ˆê³  ì²´í¬ì¸ ê³¼ì •ë„ í¸ì•ˆí–ˆìŠµë‹ˆë‹¤.",
      ];
      document.getElementById("reviews").value = sampleLines.join("\n");
    }
    
    // ì´ëª¨ì§€ ì„ íƒ
    function scoreEmoji(score) {
      if (score >= 80) return "ğŸ˜Š";
      if (score <= 40) return "ğŸ˜Ÿ";
      return "ğŸ˜";
    }
    // JSì— ìƒˆë¡œìš´ í•¨ìˆ˜ ì¶”ê°€(Day 2 Step 1)
    function credibilityScore(text) {
    let score = 50;

    function credibilityLabel(c) {
      if (c >= 80) return "ì‹ ë¢°ë„ ë†’ìŒ";
      if (c >= 55) return "ë³´í†µ";
      return "ë‚®ìŒ";
    }
    
    function credibilityClass(c) {
      if (c >= 80) return "cred--high";
      if (c >= 55) return "cred--mid";
      return "cred--low";
    }
      
    // 1) ë¦¬ë·° ê¸¸ì´ ê¸°ë°˜
    if (text.length < 10) score -= 20;
    if (text.length > 80) score += 10;
  
    // 2) êµ¬ì²´ì  ë‹¨ì–´ í¬í•¨ ì—¬ë¶€
    const detailWords = ["ê°€ê²©", "ìœ„ì¹˜", "ì†ŒìŒ", "ì¹¨ëŒ€", "ì²­ì†Œ", "ì„œë¹„ìŠ¤", "ì§ì›", "ì£¼ì°¨", "ì§€í•˜ì² "];
    if (detailWords.some(w => text.includes(w))) score += 10;
  
    // 3) ìˆ«ì í¬í•¨ â†’ ì‹ ë¢°ë„ ì¦ê°€
    if (/\d/.test(text)) score += 10;
  
    // 4) ê°íƒ„ì‚¬/ê°•ì¡° ë¶€ì‚¬ ë°˜ë³µ â†’ ì‹ ë¢°ë„ ê°ì†Œ
    const hypeWords = ["ì •ë§", "ì™„ì „", "ìµœê³ ", "ìµœì•…", "ì§„ì§œ", "ì—„ì²­"];
    let hypeCount = hypeWords.filter(w => text.includes(w)).length;
    if (hypeCount >= 2) score -= 15;
  
    // 5) ë™ì¼ ë‹¨ì–´ ë°˜ë³µ â†’ ê´‘ê³ ì„± ë¦¬ë·° ê°€ëŠ¥ì„±
    const wordSet = new Set(text.split(""));
    if (wordSet.size < text.length / 2.5) score -= 10;
  
    if (score > 100) score = 100;
    if (score < 0) score = 0;
    return score;
    }

    function renderTags(words, bgColor) {
    if (!words || words.length === 0) {
      return '<span class="chip-empty">ì—†ìŒ</span>';
    }
  
    return words
      .map(
        (w) =>
          `<span class="chip" style="background:${bgColor}; border-color:transparent;">${w}</span>`
      )
      .join("");
  }
    
    // 5. ì „ì²´ ë¶„ì„ + ì¹´ë“œ UI ì¶œë ¥
    function analyzeAll() {
      const raw = document.getElementById("reviews").value.trim();
      const lines = raw
        .split(/\n+/)
        .map((l) => l.trim())
        .filter((l) => l.length > 0);

      if (lines.length === 0) {
        document.getElementById("output").innerHTML =
          "<p>ë¦¬ë·°ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>";
        return;
      }

      let totalScore = 0;
      let totalLength = 0;
      let totalCred = 0;    // ğŸ†• ì‹ ë¢°ë„ í•©ê³„
      let cardsHtml = "";

      lines.forEach((review, idx) => {
        const score = scoreReview(review);
        const kw = extractKeywords(review);
        const length = review.length;
        const summary = summarizeReview(kw, score, credibility); // âœ… ì—¬ê¸° ìˆ˜ì •!
        const cred = credibilityScore(review);


        totalScore += score;
        totalLength += length;
        totalCred += credibility;                       // ğŸ†• ì‹ ë¢°ë„ í•©ì‚°

        let moodClass = "card--neutral";
        let scoreClass = "score-pill--neutral";
        if (score >= 75) {
          moodClass = "card--good";
          scoreClass = "score-pill--good";
        } else if (score <= 50) {
          moodClass = "card--bad";
          scoreClass = "score-pill--bad";
        }

        cardsHtml += `
          <article class="card ${moodClass}">
            <header class="card-header">
              <div class="card-title">ë¦¬ë·° #${idx + 1}</div>
              <div class="score-pill ${scoreClass}">
                ${score}ì  ${scoreEmoji(score)}
              </div>       
            </header>

            <div class="review-text">${review}</div>

            <div class="meta-row">
              <strong>ê¸€ììˆ˜</strong> ${length}ì
            </div>
            <div class="meta-row">                       
              <strong>ì‹ ë¢°ë„</strong> ${cred}ì 
            </div>

            <div class="tag-group">
              <div><span class="tag-group-label">ê¸ì •</span>${renderTags(
                kw.positive,
                "#e6f4ea"
              )}</div>
              <div><span class="tag-group-label">ë¶€ì •</span>${renderTags(
                kw.negative,
                "#fdecea"
              )}</div>
              <div><span class="tag-group-label">ì‹œì„¤</span>${renderTags(
                kw.facility,
                "#e8f0fe"
              )}</div>
              <div><span class="tag-group-label">ì„œë¹„ìŠ¤</span>${renderTags(
                kw.service,
                "#fff4e5"
              )}</div>
              <div><span class="tag-group-label">ìœ„ì¹˜</span>${renderTags(
                kw.location,
                "#e0f7fa"
              )}</div>
              <div><span class="tag-group-label">ê°€ê²©</span>${renderTags(
                kw.price,
                "#f3e5f5"
              )}</div>
            </div>

            <div class="card-summary">${summary}</div>
          </article>
        `;
      });

      const avgScore = Math.round(totalScore / lines.length);
      const avgLength = Math.round(totalLength / lines.length);
      const avgCred = Math.round(totalCred / lines.length);   // ğŸ†• ì¶”ê°€

      document.getElementById("output").innerHTML = `
        <div class="summary-bar">
          ì´ ${lines.length}ê°œì˜ ë¦¬ë·°, 
          í‰ê·  ì ìˆ˜: <strong>${avgScore}ì </strong>,
          í‰ê·  ë¦¬ë·° ê¸¸ì´: <strong>${avgLength}ê¸€ì</strong>,
          í‰ê·  ì‹ ë¢°ë„: <strong>${avgCred}ì </strong>   <!-- ğŸ†• í‘œì‹œ -->
        </div>
        ${cardsHtml}
      `;
    }
  </script>
</body>
</html>
